 📘 دليل استضافة تطبيق GAHAR KPI الشامل
دليل مفصل للمبتدئين لاستضافة التطبيق وقاعدة البيانات

---

 📋 جدول المحتويات

1. [نظرة عامة على التطبيق](overview)
2. [الملفات المطلوبة للاستضافة](files)
3. [اختيار خدمات الاستضافة](hosting-options)
4. [استضافة قاعدة البيانات (Firebase)](database-hosting)
5. [استضافة التطبيق](app-hosting)
6. [الإعدادات والتكوين](configuration)
7. [خطوات النشر التفصيلية](deployment-steps)
8. [الصيانة والتحديثات](maintenance)

---

 🔍 نظرة عامة على التطبيق {overview}

 ما هو تطبيقك؟
تطبيق GAHAR KPI هو تطبيق ويب مبني باستخدام:
- الواجهة الأمامية: Next.js (React Framework)
- قاعدة البيانات: Firebase Firestore
- المصادقة: Firebase Authentication
- نوع التطبيق: Server-Side Rendering (SSR) Application

 البنية التقنية:
```
تطبيقك
├── التطبيق نفسه (Next.js App)
│   ├── الواجهات (Pages)
│   ├── المكونات (Components)
│   └── الأنماط (Styles)
└── قاعدة البيانات (Firebase)
    ├── Firestore (تخزين البيانات)
    ├── Authentication (المصادقة)
    └── Storage (التخزين - إن وجد)
```

---

 📦 الملفات المطلوبة للاستضافة {files}

 ✅ الملفات التي يجب رفعها على استضافة التطبيق:

 1️⃣ الملفات الأساسية (إلزامية):
```
📁 المشروع الكامل/
├── 📁 app/                     ← جميع صفحات التطبيق
│   ├── page.tsx
│   ├── layout.tsx
│   ├── globals.css
│   ├── 📁 admin/
│   ├── 📁 login/
│   └── 📁 department/
│
├── 📁 lib/                     ← مكتبات Firebase والوظائف
│   ├── firebase.ts
│   ├── firestore.ts
│   └── auth.ts
│
├── 📁 public/                  ← الملفات الثابتة (صور، أيقونات)
│   └── logo.png
│
├── package.json                ← قائمة المكتبات المطلوبة
├── package-lock.json           ← نسخ المكتبات المحددة
├── tsconfig.json               ← إعدادات TypeScript
├── next.config.js              ← إعدادات Next.js
└── .env.local                  ← متغيرات البيئة (مهم جداً!)
```

 2️⃣ الملفات التي لا يجب رفعها (محذوفة):
```
❌ /node_modules/               ← سيتم تثبيتها تلقائياً
❌ /.next/                      ← سيتم بناؤها تلقائياً
❌ /out/                        ← مخرجات البناء
❌ /.git/                       ← تاريخ Git
❌ .env.local (على GitHub)     ← معلومات حساسة!
```

 ✅ الملفات المطلوبة لقاعدة البيانات (Firebase):

 Firebase لا يتطلب رفع ملفات - كل شيء يُدار عبر:
1. Firebase Console (الواجهة الإدارية)
2. Firebase CLI (أداة سطر الأوامر)

 ملفات الإعداد المحلية فقط:
```
📁 إعدادات Firebase (للتطوير فقط)/
├── firebase.json               ← إعدادات Firebase
├── firestore.rules             ← قواعد الأمان
└── .firebaserc                 ← معرفات المشاريع
```

> ملاحظة مهمة: بياناتك موجودة بالفعل على Firebase Cloud، لست بحاجة لنقلها!

---

 🌐 اختيار خدمات الاستضافة {hosting-options}

 🎯 الخيارات الموصى بها للمبتدئين:

 الخيار 1: Firebase Hosting + Firebase (الأسهل والمجاني) ⭐ موصى به

| المميزات | العيوب |
|----------|--------|
| ✅ مجاني بالكامل (حد معقول) | ⚠️ محدود بميزات Firebase |
| ✅ سهل جداً للمبتدئين | ⚠️ قد لا يدعم جميع ميزات Next.js |
| ✅ قاعدة البيانات والاستضافة معاً | |
| ✅ شهادة SSL مجانية | |
| ✅ CDN عالمي سريع | |
| ✅ لا يحتاج بطاقة ائتمان | |

السعر: مجاني (حتى حدود مرتفعة جداً)
مناسب لـ: المشاريع الصغيرة والمتوسطة، المبتدئين

---

 الخيار 2: Vercel + Firebase (الأفضل لـ Next.js) ⭐⭐ موصى به بشدة

| المميزات | العيوب |
|----------|--------|
| ✅ مُحسّن خصيصاً لـ Next.js | ⚠️ يتطلب حساب GitHub |
| ✅ مجاني (حد سخي جداً) | ⚠️ قد يتطلب بطاقة ائتمان للترقية |
| ✅ نشر تلقائي من GitHub | |
| ✅ SSL تلقائي | |
| ✅ معاينات للنشر | |
| ✅ دعم رسمي لـ Next.js | |

السعر: مجاني (حتى 100GB نقل بيانات/شهر)
مناسب لـ: جميع أحجام المشاريع، الأفضل لـ Next.js

---

 الخيار 3: Netlify + Firebase (سهل وقوي)

| المميزات | العيوب |
|----------|--------|
| ✅ مجاني (حد جيد) | ⚠️ قد لا يدعم بعض ميزات Next.js |
| ✅ واجهة سهلة جداً | ⚠️ أبطأ قليلاً من Vercel |
| ✅ نشر تلقائي من Git | |
| ✅ SSL مجاني | |

السعر: مجاني (حتى 100GB نقل/شهر)
مناسب لـ: المشاريع المتوسطة

---

 الخيار 4: DigitalOcean App Platform + Firebase (متقدم)

| المميزات | العيوب |
|----------|--------|
| ✅ تحكم كامل | ❌ غير مجاني (يبدأ من $5/شهر) |
| ✅ سيرفر خاص | ❌ يتطلب خبرة تقنية |
| ✅ موارد مخصصة | ❌ يحتاج بطاقة ائتمان |

السعر: من $5 - $25/شهر
مناسب لـ: المشاريع الكبيرة، المحترفين

---

 الخيار 5: Railway + Firebase (سهل ومرن)

| المميزات | العيوب |
|----------|--------|
| ✅ سهل الإعداد | ⚠️ حد مجاني محدود ($5 رصيد/شهر) |
| ✅ دعم جيد لـ Next.js | ⚠️ بعد الحد المجاني يحتاج دفع |
| ✅ واجهة بسيطة | |

السعر: $5 مجاناً/شهر ثم $10+/شهر
مناسب لـ: المشاريع المتوسطة

---

 🎖️ التوصية النهائية للمبتدئين:

 للمبتدئين 100%:
👉 Vercel + Firebase (الأسهل والأفضل والمجاني)

لماذا؟
- ✅ مجاني تماماً
- ✅ نشر في 3 دقائق فقط
- ✅ محسّن لـ Next.js (تطبيقك مبني عليه)
- ✅ Firebase مجاني أيضاً
- ✅ لا يحتاج خبرة تقنية
- ✅ تحديثات تلقائية من GitHub

---

 🗄️ استضافة قاعدة البيانات (Firebase) {database-hosting}

 ✨ الخبر السار: قاعدة بياناتك مستضافة بالفعل!

إذا كنت تستخدم Firebase Firestore، فإن بياناتك موجودة بالفعل على سحابة Google، ولا تحتاج لفعل أي شيء إضافي!

 📍 أين توجد بياناتك الآن؟
1. افتح [Firebase Console](https://console.firebase.google.com/)
2. اختر مشروعك
3. من القائمة الجانبية → Firestore Database
4. ستجد كل بياناتك موجودة هنا!

 🔐 خطوات تأمين قاعدة البيانات:

 1️⃣ إعداد قواعد الأمان (مهم جداً!):

```javascript
// ملف: firestore.rules
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // قاعدة للمستخدمين - فقط المسجلين
    match /users/{userId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // قاعدة للبيانات - حسب الصلاحيات
    match /kpi_data/{document=} {
      allow read: if request.auth != null;
      allow create, update: if request.auth != null;
      allow delete: if request.auth != null && 
                      get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'super_admin';
    }
  }
}
```

 2️⃣ نشر قواعد الأمان:

افتح Terminal/Command Prompt في مجلد المشروع:
```bash
firebase deploy --only firestore:rules
```

 3️⃣ تصدير البيانات (نسخة احتياطية):

من Firebase Console:
1. اذهب إلى Firestore Database
2. اضغط على علامة ⋮ (ثلاث نقاط)
3. اختر Export data
4. اختر مجلد التخزين (Cloud Storage)
5. اضغط Export

> نسخ احتياطية تلقائية: يمكنك إعداد نسخ احتياطية يومية تلقائية من إعدادات Firebase

---

 🚀 استضافة التطبيق {app-hosting}

سنشرح طريقتين: Vercel (الأسهل) و Firebase Hosting

---

 🎯 الطريقة الأولى: Vercel (موصى بها) {vercel-hosting}

 المتطلبات:
- ✅ حساب GitHub (مجاني)
- ✅ حساب Vercel (مجاني)
- ✅ مشروع Firebase (لديك بالفعل)

---

 الخطوة 1: رفع المشروع على GitHub

 1.1 إنشاء حساب GitHub (إذا لم يكن لديك):
1. اذهب إلى [github.com](https://github.com)
2. اضغط Sign Up
3. أدخل بريدك الإلكتروني وكلمة مرور
4. أكمل التسجيل

 1.2 إنشاء مستودع (Repository) جديد:
1. اضغط على + في الأعلى ← New repository
2. اسم المستودع: `gahar-kpi-app`
3. اجعله Private (خاص)
4. اضغط Create repository

 1.3 رفع الملفات على GitHub:

الطريقة الأولى: عبر GitHub Desktop (سهلة للمبتدئين):

1. حمّل [GitHub Desktop](https://desktop.github.com/)
2. سجل الدخول بحسابك
3. اختر File → Add Local Repository
4. اختر مجلد مشروعك: `d:\تطبيقي\app`
5. إذا لم يكن مستودع Git:
   - اضغط Create a repository
   - اتبع التعليمات
6. اضغط Publish repository
7. اختر Private ← Publish

الطريقة الثانية: عبر Command Line:

```bash
 في مجلد المشروع d:\تطبيقي\app
cd d:\تطبيقي\app

 تهيئة Git
git init

 إضافة جميع الملفات
git add .

 أول Commit
git commit -m "Initial commit - GAHAR KPI App"

 ربط المستودع (استبدل YOUR_USERNAME باسمك)
git remote add origin https://github.com/YOUR_USERNAME/gahar-kpi-app.git

 رفع الملفات
git branch -M main
git push -u origin main
```

---

 الخطوة 2: إنشاء ملف متغيرات البيئة

⚠️ مهم جداً: لا ترفع ملف `.env.local` على GitHub!

 2.1 تأكد من وجود `.gitignore`:
تأكد أن ملف `.gitignore` يحتوي على:
```
.env.local
.env.local
```

 2.2 احفظ بيانات Firebase في مكان آمن:
من ملف `lib/firebase.ts`، احفظ هذه البيانات:

```typescript
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
```

---

 الخطوة 3: النشر على Vercel

 3.1 إنشاء حساب Vercel:
1. اذهب إلى [vercel.com](https://vercel.com)
2. اضغط Sign Up
3. اختر Continue with GitHub
4. وافق على الأذونات

 3.2 استيراد المشروع:
1. من لوحة Vercel ← اضغط Add New... → Project
2. اختر مستودع `gahar-kpi-app`
3. اضغط Import

 3.3 إعداد المشروع:
```
Framework Preset: Next.js
Root Directory: ./
Build Command: npm run build
Output Directory: .next
Install Command: npm install
```

 3.4 إضافة متغيرات البيئة (Environment Variables):
في صفحة الإعدادات، أضف المتغيرات التالية:

```
NEXT_PUBLIC_FIREBASE_API_KEY=your_api_key_here
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
NEXT_PUBLIC_FIREBASE_APP_ID=your_app_id
```

> ملاحظة: قد تكون بيانات Firebase مكتوبة مباشرة في الكود، هذا جيد لـ Firebase لأنها تُؤمَّن بقواعد الأمان

 3.5 النشر:
1. اضغط Deploy
2. انتظر 2-3 دقائق
3. ستحصل على رابط مثل: `https://gahar-kpi-app.vercel.app`

---

 الخطوة 4: ربط نطاق خاص (اختياري)

إذا أردت نطاق خاص مثل `gahar-kpi.com`:

1. من لوحة Vercel → اختر المشروع
2. اذهب إلى Settings → Domains
3. أضف نطاقك
4. اتبع تعليمات ربط DNS

---

 الخطوة 5: التحديثات التلقائية

🎉 ميزة رائعة: كل تحديث على GitHub سيُنشر تلقائياً!

```bash
 في مجلد المشروع
 بعد تعديل أي ملف:

git add .
git commit -m "تحديث: وصف التعديل"
git push

 Vercel سينشر التحديثات تلقائياً في دقائق!
```

---

 🔥 الطريقة الثانية: Firebase Hosting {firebase-hosting}

 المتطلبات:
- ✅ حساب Firebase (لديك بالفعل)
- ✅ Node.js مثبت على جهازك
- ✅ Firebase CLI

---

 الخطوة 1: تثبيت Firebase CLI

افتح Terminal/PowerShell:
```bash
npm install -g firebase-tools
```

 الخطوة 2: تسجيل الدخول

```bash
firebase login
```
- سيفتح متصفح للتسجيل
- سجل دخول بحسابك
- اقبل الأذونات

 الخطوة 3: تهيئة المشروع

في مجلد التطبيق:
```bash
cd d:\تطبيقي\app

 تهيئة Firebase
firebase init hosting
```

اختر الإجابات:
```
? What do you want to use as your public directory? out
? Configure as a single-page app? No
? Set up automatic builds and deploys with GitHub? No
```

 الخطوة 4: بناء التطبيق

```bash
 بناء Next.js للتصدير الثابت
npm run build
```

⚠️ مشكلة محتملة: Next.js SSR لا يدعم التصدير الثابت كاملاً.

الحل: تعديل `next.config.js`:
```javascript
/ @type {import('next').NextConfig} /
const nextConfig = {
  output: 'export',
  images: {
    unoptimized: true,
  },
}

module.exports = nextConfig
```

ثم أعد البناء:
```bash
npm run build
```

 الخطوة 5: النشر

```bash
firebase deploy --only hosting
```

ستحصل على رابط مثل:
```
https://your-project-id.web.app
```

---

 ⚠️ قيود Firebase Hosting:

| الميزة | Firebase | Vercel |
|--------|----------|--------|
| Server-Side Rendering | ❌ غير مدعوم | ✅ مدعوم |
| API Routes | ❌ غير مدعوم | ✅ مدعوم |
| Static Export | ✅ مدعوم | ✅ مدعوم |
| السهولة | متوسطة | سهل جداً |

التوصية: استخدم Vercel لتطبيقات Next.js

---

 ⚙️ الإعدادات والتكوين {configuration}

 🔐 إعدادات Firebase (مهمة جداً!)

 1️⃣ إعداد المجالات المسموحة (Authorized Domains):

1. افتح [Firebase Console](https://console.firebase.google.com/)
2. اختر مشروعك
3. Authentication → Settings → Authorized domains
4. أضف:
   ```
   localhost (للتطوير)
   your-app.vercel.app (نطاق Vercel)
   your-custom-domain.com (نطاقك الخاص)
   ```

 2️⃣ إعداد CORS:

من Firebase Console → Storage → Rules:
```
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
  }
}
```

 3️⃣ تفعيل طرق المصادقة:

1. Authentication → Sign-in method
2. فعّل Email/Password
3. احفظ

---

 📝 ملف package.json النهائي:

تأكد من وجود هذه السكريبتات:
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "export": "next build && next export"
  }
}
```

---

 📊 خطوات النشر التفصيلية (ملخص) {deployment-steps}

 ✅ قائمة التحقق السريعة:

 قبل النشر:
- [ ] تأكد من عمل التطبيق محلياً (`npm run dev`)
- [ ] اختبر جميع الصفحات والميزات
- [ ] تحقق من إعدادات Firebase
- [ ] نظّف الكود من التعليقات والـ console.log
- [ ] راجع ملف `.gitignore`

 إعداد Firebase:
- [ ] قواعد الأمان صحيحة (Firestore Rules)
- [ ] المجالات المسموحة مضافة (Authorized Domains)
- [ ] المصادقة مفعّلة (Email/Password)
- [ ] نسخة احتياطية للبيانات

 إعداد Git و GitHub:
- [ ] إنشاء مستودع GitHub
- [ ] رفع الكود (بدون .env.local)
- [ ] التأكد من اكتمال الرفع

 النشر على Vercel:
- [ ] ربط المستودع
- [ ] إضافة متغيرات البيئة
- [ ] نشر التطبيق
- [ ] اختبار الرابط الناتج

 بعد النشر:
- [ ] اختبار تسجيل الدخول
- [ ] اختبار إضافة بيانات
- [ ] اختبار الصلاحيات
- [ ] اختبار على أجهزة مختلفة

---

 🔄 الصيانة والتحديثات {maintenance}

 📅 مراقبة الأداء:

 Firebase Console:
1. Analytics → عدد الزيارات والمستخدمين
2. Performance → سرعة التطبيق
3. Firestore → حجم البيانات المستخدم

 Vercel Dashboard:
1. Analytics → أداء الصفحات
2. Deployments → تاريخ النشر
3. Logs → سجل الأخطاء

---

 🔄 تحديث التطبيق:

 الطريقة التلقائية (مع GitHub):
```bash
 في مجلد المشروع
git add .
git commit -m "وصف التحديث"
git push
```
↓ Vercel ينشر تلقائياً في دقائق

 الطريقة اليدوية (Firebase):
```bash
npm run build
firebase deploy --only hosting
```

---

 💾 النسخ الاحتياطي:

 نسخ احتياطي للبيانات (شهرياً):
1. Firebase Console → Firestore
2. Import/Export → Export
3. احفظ في Cloud Storage

 نسخ احتياطي للكود:
- GitHub يحفظ كل التحديثات تلقائياً
- يمكنك الرجوع لأي نسخة قديمة

---

 📈 المراقبة والتنبيهات:

 إعداد تنبيهات البريد (Firebase):
1. Firebase Console → Project Settings
2. Integrations → Cloud Monitoring
3. أضف إيميلك للتنبيهات

---

 🎯 ملخص التوصيات النهائية

 للمبتدئين:
```
✅ قاعدة البيانات: Firebase Firestore (مجاني)
✅ الاستضافة: Vercel (مجاني)
✅ النطاق: subdomain.vercel.app (مجاني)
💰 التكلفة الكلية: 0 ريال/شهر
```

 للاحترافيين:
```
✅ قاعدة البيانات: Firebase Firestore
✅ الاستضافة: Vercel Pro أو DigitalOcean
✅ النطاق: نطاقك الخاص (.com/.sa)
💰 التكلفة: 50-200 ريال/شهر
```

---

 📞 دعم إضافي

 الموارد المفيدة:
- [توثيق Next.js](https://nextjs.org/docs)
- [توثيق Firebase](https://firebase.google.com/docs)
- [توثيق Vercel](https://vercel.com/docs)
- [مجتمع Stack Overflow](https://stackoverflow.com/)

 الأخطاء الشائعة وحلولها:

 ❌ خطأ: "Firebase configuration error"
✅ الحل: تحقق من صحة بيانات Firebase في متغيرات البيئة

 ❌ خطأ: "Build failed"
✅ الحل: راجع سجل الأخطاء في Vercel، غالباً مشكلة في التبعيات

 ❌ خطأ: "Permission denied" في Firestore
✅ الحل: راجع قواعد الأمان (Firestore Rules)

 ❌ خطأ: "Auth domain not authorized"
✅ الحل: أضف النطاق في Firebase → Authentication → Authorized domains

---

 ✅ الخلاصة

 خطوات النشر السريعة (5 دقائق):

1. رفع الكود على GitHub (دقيقتان)
2. ربط Vercel بـ GitHub (دقيقة واحدة)
3. إضافة بيانات Firebase (دقيقة واحدة)
4. النشر (دقيقة واحدة)
5. ✅ تطبيقك أصبح متاحاً على الإنترنت!

---

 💡 نصائح أخيرة:

1. ابدأ بالخيار المجاني (Vercel + Firebase)
2. لا ترفع .env على GitHub أبداً
3. اعمل نسخ احتياطية شهرياً
4. راقب الأداء والأخطاء باستمرار
5. اقرأ التوثيق الرسمي عند وجود مشاكل

---

🎉 مبروك! أنت الآن جاهز لنشر تطبيقك على الإنترنت!

---

آخر تحديث: نوفمبر 2025
الإصدار: 1.0
